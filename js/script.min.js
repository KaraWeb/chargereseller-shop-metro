$(document).ready(function(){var t=!1,e="TopUp",a="MTN",n=$(window).outerHeight();n>638&&(n=638),$("#dataChargeKind").val("");var c=n-175;$(".load").css("height",n+"px"),$(".sticky-menu").hide(),$("#CellphoneInput").val($.cookie("cellphone")),$("#EmailInput").val($.cookie("email")),$(window).ready(function(){$(window).outerWidth()<1001?$(".slider").css("height","auto"):$(".slider").css("height",c+"px"),h()}),$(window).resize(function(){$(window).outerWidth()<1001?$(".slider").css("height","auto"):$(".slider").css("height",c+"px"),h()});var l=0;function s(t){var e=t.substr(t.length-1,1);for(t=(t=t.substr(0,t.length-1)).split(""),coefficient=2,billLength=t.length,sum=0,i=billLength-1;i>=0;i--)sum+=coefficient*t[i],coefficient++,8==coefficient&&(coefficient=2);return calculatedCheckSum=sum%11,1==calculatedCheckSum||0==calculatedCheckSum?calculatedCheckSum=0:calculatedCheckSum=11-calculatedCheckSum,calculatedCheckSum==e}function o(t,e){var a="";if(""!=e)var i=products[t][e];else i=products[t];groupPascalCase=t.charAt(0).toUpperCase()+t.slice(1),$.each(i,function(t,e){a+='<section data-product-id="'+e.id+'" data-price="'+e.price+'"><div  class="credit-info">'+e.name+'</div><div class="price-info">'+e.price+" تومان</div><div class='clear'></div></section>"}),$(".list").html(a).show(),$("#dataProductId").val($(".list section:first-child").data("product-id")),$("#dataAmount").val($(".list section:first-child").data("price")),$(".list section:first-child").addClass("active"),$(".list section div:first-child").css("direction","rtl"),$('.list section div:first-child:contains("گیفت کارت")').each(function(){$(this).html($(this).html().split("گیفت کارت").join(""))}),$('.list section div:first-child:contains("XBox")').each(function(){$(this).html($(this).html().split("XBox").join("ایکس باکس "))}),$('.list section div:first-child:contains("PlayStationNetwork")').each(function(){$(this).html($(this).html().split("PlayStationNetwork").join("")),$(this).prepend("پلی استیشن ")}),$('.package section div:first-child:contains("اینترنت ایرانسل")').each(function(){$(this).html($(this).html().split("اینترنت ایرانسل").join(""))}),$('.package section div:first-child:contains("اینترنت ثابت TDLTE")').each(function(){$(this).html($(this).html().split("اینترنت ثابت TDLTE").join("ثابت"))}),$('.package section div:first-child:contains("(مشترکین دائمی)")').each(function(){$(this).html($(this).html().split("(مشترکین دائمی)").join(""))}),$('.package section div:first-child:contains("(مشترکین اعتباری)")').each(function(){$(this).html($(this).html().split("(مشترکین اعتباری)").join(""))}),$("#product-type").html($(".list section.active div:first-child").html())}function d(t,e,a,i){var n=products.internetPackage[t];if(null==e)$("section.internet-package").find(".sim-type").html("<div class='clear'></div>"),$.each(n,function(t,e){$("section.internet-package").find(".sim-type").append("<section data-type='"+t+"'><label class='charge-type'><input type='radio' name='radio-sim-type' class='charge-button'/><p>"+t+"</p></label></section>")}),$("section.internet-package").find(".sim-type section").first().trigger("click");else if(null==a){var c=n[e];$("section.internet-package").find("select").html(""),$.each(c,function(t,e){$("section.internet-package").find("select").append("<option data-package-type='"+t+"'>"+t+"</option>")}),$("section.internet-package").find("select").first().trigger("change")}else{var l=n[e][a];$(".package").html(""),null==l?$(".package").html("بسته ای در این دسته وجود ندارد."):($.each(l,function(t,e){var a='<section data-package-id="'+e.id+'" data-price="'+e.price+'"><div  class="credit-info">'+e.name+", "+e.price+" تومان</div></section>";$(".package").append(a)}),null==i?$(".package section").first().trigger("click"):$(".package").find('section[data-package-id="'+i+'"]').trigger("click"))}}function r(){var t=$(".counter").val(),e=$("#dataAmount").val();$("input[name='data[count]']").val(t),""==e?($("#product-count").html(""),$("#product-price").html(""),$("#final-price , .price").html("")):($("#product-count").html(t+"&nbspعدد"),$("#product-price").html(e+"&nbspتومان"),$("#final-price , .price").html(e*t+"&nbspتومان"),$("get-final-price").val(e))}function p(){var t=$("#dataAmount").val();$("#dataCount").val(1),""==t?$("#package-price").html(""):$("#package-price").html(1*t+"&nbspتومان")}function h(){if($(window).outerWidth()<501){var t=($(window).height()-$(".slider").height()-31)/3+"px";console.log(t),$(".menu div").css("height",t)}else $(".menu div").css("height","auto")}$(".menu div").click(function(){if(0==l&&($(".sticky-menu").fadeIn(),l++),$(this).data("type")==$("#dataChargeKind").val())return!1;$(".invoice .antivirus li").css("margin-bottom","15px"),$(".giftcard-types").removeClass("active"),$(".antivirus-types").removeClass("active");var t="."+$(this).data("type").toLowerCase();if(".internetpackage"==t&&(t=".internet-package"),$(".invoice div").slideUp(300,"swing"),$(".invoice "+t).slideDown(300,"swing"),$(".hint-cell, .hint-mail").slideUp(),$(".information").css("padding","36px 0"),$(".checkbox").prop("checked",!1),$(".operator").removeClass("active"),$(".menu div").removeClass("active"),$(this).addClass("active"),$("#dataChargeKind").val($(this).data("type")),e=$("#dataChargeKind").val(),$(t+" div:first-child div:first-child").addClass("active"),$(".slider, .header").slideUp(700,"swing"),$(".content").slideDown(1100,"swing"),$(".bargain > section").slideUp(),$(t).slideDown(),$("#product-type").html($(t+" div:first-child div:first-child").data("name")),$("#dataType").val($(t+" div:first-child div:first-child").data("type")),$(".charge-button").prop("checked",!1),$(t+" .charge-type-container section:first-child input").prop("checked",!0),$(".charge-type div").hide(),$(t+" .charge-type-container section:first-child div").show(),$("#dataAmount").val($(t+" .charge-type-container section:first-child label").data("price")),$(".counter").val(1),$(".magiccharge, .nonecredit-mtn, .wimax").show(),"giftcard"==$(this).data("type")&&o("giftCard",$(".giftcard-types.active").data("giftcard-type")),"antivirus"==$(this).data("type")&&(o("antivirus",$(".antivirus-types.active").data("antivirus-type")),$(".invoice .antivirus li").css("margin-bottom","5px")),"InternetPackage"==$(this).data("type"))return d("mtn"),void p();r()}),$(".charge-type").click(function(){$(".charge-type div").hide(),$(this).find("div").show(),$(".counter").val(1),price=$(this).data("price"),$("#dataAmount").val(price),$("#product-price").html(price+"&nbspتومان"),r()}),$(".operator").click(function(){$(".checkbox").prop("checked",!1),$(".operator").removeClass("active"),$(this).addClass("active"),$(".counter").val(1),$("#product-type").html($(this).data("name")),$("#dataType").val($(this).data("type")),a=$(this).data("type"),"MTN"==$("#dataType").val()?($(".magiccharge label").text("شارژ شگفت انگیز"),$(".magiccharge, .nonecredit-mtn, .wimax").show()):"RTL"==$("#dataType").val()?($(".magiccharge label").text("شارژ شور انگیز"),$(".magiccharge").show(),$(".nonecredit-mtn, .wimax").hide()):$(".magiccharge, .nonecredit-mtn, .wimax").hide(),r()}),$(".increase").click(function(){countBoxValue=parseInt($(".counter").val()),countBoxValue>=1&&countBoxValue<5&&($(".counter").val(countBoxValue+1),r())}),$(".decrease").click(function(){countBoxValue=parseInt($(".counter").val()),countBoxValue>1&&($(".counter").val(countBoxValue-1),r())}),$(".checkbox").change(function(){var t=$(this).attr("id");$.each(["magiccharge","nonecredit-mtn","wimax"],function(e,a){t!=a&&$("#"+a).prop("checked",!1)}),"MTN"==$("#dataType").val()||"MTN!"==$("#dataType").val()||"MTN#"==$("#dataType").val()||"WiMax"==$("#dataType").val()?("magiccharge"==t?$("#dataType").val("MTN!"):"nonecredit-mtn"==t?$("#dataType").val("MTN#"):"wimax"==t&&$("#dataType").val("WiMax"),0==$(this).prop("checked")&&$("#dataType").val("MTN")):"RTL"!=$("#dataType").val()&&"RTL!"!=$("#dataType").val()||("magiccharge"==t&&$("#dataType").val("RTL!"),0==$(this).prop("checked")&&$("#dataType").val("RTL")),a=$("#dataType").val()}),$(document).on("input","input.cellphone",function(){this.value=this.value.replace(/[^\d\.\-]/g,"")}),$(".counter").keydown(function(){return!1}),$(".internet-package option").click(function(){$(".package div").hide();var t=$(this).data("package-type").toLowerCase();$("."+t).slideDown()}),$("section.internet-package select").change(function(){"IN-MTN-TDLTE"==$(this).find(":selected").data("package-type")?($(".sim-type").hide(),$(".package").css("margin-top","30px")):($(".sim-type").show(),$(".package").css("margin-top","0px"))}),$(document).on("click",".package section",function(){$(".package section").removeClass("active"),$(this).addClass("active"),$("#dataPackageId").val($(this).data("package-id")),$("#dataAmount").val($(this).data("price"));var t=$(this).find("div").html().split(",")[0];$("#package-name").text(t),p()}),$(".return").click(function(){$(".load").fadeOut()}),$(".giftcard-types").click(function(){$(".giftcard-types").removeClass("active"),$(this).addClass("active"),$(".counter").val(1),o("giftCard",$(this).data("giftcard-type")),r()}),$(".antivirus-types").click(function(){$(".antivirus-types").removeClass("active"),$(this).addClass("active"),$(".counter").val(1),o("antivirus",$(this).data("antivirus-type")),r()}),$(document).on("click",".list section",function(){$(".list section").removeClass("active"),$(this).addClass("active"),$("#dataProductId").val($(this).data("product-id")),$("#dataAmount").val($(this).data("price")),$("#product-type").html($(".list section.active div:first-child").html()),r()}),$(".gateway").click(function(){$(".gateway").removeClass("active"),$(this).addClass("active"),$("#dataIssuer").val($(this).data("gateway-type"))}),$(".submit").click(function(i){if("bill-payment"==$("#dataChargeKind").val()&&(""==$("#dataBillId").val()||""==$("#dataPaymentId")))return $(".hint-bill").text("شناسه قبض و شناسه پرداخت را وارد نمایید","تذکر"),$(".hint-bill").slideDown(),!1;$(".load section:first-child").fadeIn(),$(".load section:last-child").hide(),i.preventDefault();var n="";return"TopUp"==$("#dataChargeKind").val()?n="topup":"InternetPackage"==$("#dataChargeKind").val()?n="internetRecharge":"bill-payment"==$("#dataChargeKind").val()?n="bill":"PIN"==$("#dataChargeKind").val()?(n="buyProduct",$("#dataProductId").val("CC-"+$("#dataType").val()+"-"+$("#dataAmount").val())):n="buyProduct",function(){$(".hint-cell, .hint-mail").slideUp(),$(".hint-cell p").text("شماره وارد شده صحیح نیست."),$("#dataCellphone").val($("input.cellphone").val()),$("#dataEmail").val($("input.email").val());var i=!0,n=!0,c=!0,l=!0,s=$("input.cellphone").val(),o=$("input.email").val();jQuery.inArray(e,["PIN","TopUp","WiMax"])>-1&&"charge";if("TopUp"==e){11!=s.length||isNaN(s)?0==s.length?(n=!1,$(".hint-cell p").text("شماره موبایل خود را وارد کنید.")):n=!1:"MTN"==a||"MTN!"==a||"MTN#"==a?-1==jQuery.inArray(s.substring(0,3),["093","090"])&&(n=!1):"MCI"==a?-1==jQuery.inArray(s.substring(0,3),["091","099"])&&(n=!1):"RTL"==a||"RTL!"==a?-1==jQuery.inArray(s.substring(0,4),["0921","0922"])&&(n=!1):11!=s.length||isNaN(s)||"WiMax"==a&&-1==jQuery.inArray(s.substr(0,3),["094"])&&(n=!1,$(".hint-cell p").text("شماره وارد شده صحیح نیست."));var d=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;o.length>0&&!d.test(o)&&(c=!1)}else if("PIN"==e)if(0!=s.length&&-1==jQuery.inArray(s,["093","090","091","092"])||0!=o.length){var d=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;o.length>0&&!d.test(o)&&(c=!1),c&&-1==jQuery.inArray(s,["093","090","091","092"])&&(n=11!=s.length||isNaN(s)?0==s.length:-1!=jQuery.inArray(s.substr(0,3),["090","091","092","093","099"]))}else n=!1,i=!1,$(".hint-cell p").text("جهت استفاده از خدمات پشتیبانی، ایمیل یا شماره موبایل خود را وارد نمایید.");else if("InternetPackage"==e){var r={mtn:/(0)?9([0,3]{1})\d{8}/,mci:/(0)?9([1,9]{1})\d{8}/,tdlte:/(0)?94\d{8}/,rtl:/^([0]{1})([9]{1})([2]{1})([1,2]{1})([0-9]{7})$/},p=r[a.toLowerCase()],h=$(".internet-package").find("section.active").data("type");h.includes("ثابت")&&(p=r.tdlte),p.test(s)||(n=!1)}else if(0==s.length&&0==o.length)i=!1,"bill-payment"==$("#dataChargeKind").val()?$(".hint-cell p").text("جهت استفاده از خدمات پشتیبانی، ایمیل یا شماره موبایل خود را وارد نمایید."):$(".hint-cell p").text("سریال محصولات خریداری شده تنها به شماره موبایل شما ارسال خواهد شد.");else{var d=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;o.length>0&&!d.test(o)&&(c=!1),s.length>0?n=11==s.length&&!isNaN(s)&&-1!=jQuery.inArray(s.substr(0,3),["090","091","092","093","099"]):(n=!1,$(".hint-cell p").text("سریال محصولات خریداری شده تنها به شماره موبایل شما ارسال خواهد شد."))}0==n?($(".hint-cell").slideDown(),$(".information").css("padding","15px 0")):($(".hint-cell").slideUp(),$(".information").css("padding","36px 0"));0==c?($(".hint-mail").slideDown(),$(".information").css("padding","15px 0")):($(".hint-mail").slideUp(),$(".information").css("padding","36px 0"));0==i&&($(".hint-cell").slideDown(),$(".information").css("padding","15px 0"));"PIN"!=e&&"TopUp"!=e||($("input#dataAmount").val()<500||$("input#dataAmount").val()>5e4?($("div.input.text.amount div.message").length<=0&&($("div.input.text.amount").prepend('<div class="message error-message">مبلغ وارد شده میبایست بزرگتر از 500 و کوچک تر از 50،000 تومان باشد.</div>'),$("div.input.select.amount").prepend('<div class="message error-message">مبلغ وارد شده میبایست بزرگتر از 500 و کوچک تر از 50،000 تومان باشد.</div>')),l=!1):($("div.input.text.amount div.message").remove(),l=!0));t=!!(i&&n&&c&&l)}(),t&&($(".load").fadeIn(),$(".load section:first-child p").text("دریافت اطلاعات ..."),$.ajax({type:"POST",url:"https://chr724.ir/services/v3/EasyCharge/"+n,data:$("form#myForm").serialize(),async:!1,contentType:"application/json",dataType:"jsonp",crossDomain:!0,success:function(t){var e;$(".load section:first-child p").text("انتقال به بانک ..."),"Success"==(e=t).status?"Zarinpal"==$("#dataIssuer").val()?(Zarinak.setAuthority(e.paymentInfo.paymentGateway.authority),Zarinak.open(),$(".connecting p").text("لطفاً صبر کنید ...")):window.location.replace(e.paymentInfo.url):(console.log(e),$(".load section:first-child").hide(),$(".load section:last-child p").text(e.errorMessage),$(".load section:last-child").removeClass("hide"),$(".load section:last-child").show())},error:function(t){$(".load section:first-child").fadeOut(),$(".load section:last-child p").text("در حال حاضر امکان برقرار ارتباط با سرور وجود ندارد. (خطا: "+t.status+")<br>لطفاً بعداً مراجعه نمایید.","خطا"),$(".load section:last-child").removeClass("hide")}}),$("input.save-information").prop("checked")&&($.cookie("cellphone",$("input#dataCellphone").val()),$.cookie("email",$("input#dataEmail").val()))),!1}),$("input#CheckBill").click(function(){$(".invoice .bill-payment .final-price").text(""),$(".invoice .bill-payment .product-type").css("display","none"),$(".hint-bill, .hint-pay").slideUp();var t=!0,e=!0,a=!0,i=!0,n=($("#CellphoneInput").val(),$("#EmailInput").val(),$("#BillId").val()),c=$("#PaymentId").val();if(""==n||""==c)return i=!0,$(".hint-bill").text("شناسه قبض و شناسه پرداخت را وارد نمایید","تذکر"),void $(".hint-bill").slideDown();if(isNaN(n)||isNaN(c)?(i=!1,$(".hint-bill").text("شناسه قبض و شناسه پرداخت فقط باید عدد باشند.","تذکر"),$(".hint-bill").slideDown()):(s(n.replace(/^[0]+/g,""))||(t=!1),s(c.substr(0,c.length-1).replace(/^[0]+/g,""))||(e=!1),s(n.replace(/^[0]+/g,"")+c.replace(/^[0]+/g,""))||(a=!1)),i&&t&&e){if(!a)return $(".hint-bill").text("شناسه قبض با شناسه پرداخت همخوانی ندارد.","تذکر"),void $(".hint-bill").slideDown();var l=n.length,o=c.length,d=n.substr(l-2,1)-1,r=100*c.substr(0,o-5);$("#dataBillId").val(n),$("#dataPaymentId").val(c),$("#dataAmount").val(r),$(".invoice .bil-payment .product-type").text(["آب","برق","گاز","تلفن ثابت","تلفن همراه","عوارض شهرداری","","","راهنمایی و رانندگی"][d]),$(".invoice .bill-payment .final-price").text(r+" تومان"),$(".invoice .bill-payment .product-type").addClass(["water","electricity","gas","telephone","cellphone","mayoralty","","","police"][d]),$(".invoice .bill-payment .product-type").css("display","inline-block")}0==t&&$(".buy.bill .bill-id div.message").length<=0&&($(".hint-bill").text("شناسه قبض معتبر نیست."),$(".hint-bill").slideDown()),0==e&&$(".buy.bill .payment-id div.message").length<=0&&($(".hint-pay").text("شناسه پرداخت معتبر نیست."),$(".hint-pay").slideDown())}),$.ajax({type:"GET",url:"https://chr724.ir/services/v3/EasyCharge/initializeDataCategorizedFormat",data:"{}",async:!1,contentType:"application/json",dataType:"jsonp",crossDomain:!0,success:function(t){products=t.products,paymentGateways=t.paymentGateways,function(){var t=0;$.each(paymentGateways,function(e,a){$(".gateway[data-gateway-type="+a+"]").css("display","inline-block"),t+=1}),t>3?$(".gateways-container").css("margin","10px auto"):$(".gateways-container").css("margin","40px auto");$.each(products,function(t,e){jQuery.isEmptyObject(e)&&$("#content fieldset > ."+t).html('<p class="service-caution">در حال حاضر در این دسته محصولی برای فروش وجود ندارد.</p>')}),$.each(paymentGateways,function(t,e){$("div.payment-gateways ul li#"+e).attr("style","display:inline-block;")}),$("div.payment-gateways ul").attr("style","width:"+55*paymentGateways.length+"px;"),$.each(products.giftCard,function(t,e){""==e||null==e?$(".giftcard-types."+t).hide():$(".giftcard-types."+t).css("display","inline-block")}),$.each(products.antivirus,function(t,e){t=t.toLowerCase(),""==e||null==e?$(".antivirus-types."+t).hide():$(".antivirus-types."+t).css("display","inline-block")}),$(".bgs").slideDown(300);var e=window.location.href;e.match("#topup$")?$('div[data-type="TopUp"]').trigger("click"):e.match("#pin$")?$('div[data-type="PIN"]').trigger("click"):e.match("#internetPackage$")?$('div[data-type="InternetPackage"]').trigger("click"):e.match("#bill$")?$('div[data-type="bill-payment"]').trigger("click"):e.match("#giftcard$")?$('div[data-type="giftcard"]').trigger("click"):e.match("#antivirus$")&&$('div[data-type="antivirus"]').trigger("click")}(),$(".load").fadeOut()},error:function(t){$(".load section:first-child").hide(),$(".load section:last-child p").text("در حال حاضر امکان برقرار ارتباط با سرور وجود ندارد. (خطا: "+t.status+")لطفاً بعداً مراجعه نمایید.","خطا"),$(".load section:last-child").removeClass("hide")}}),$(".internet-package").find(".operator").on("click",function(){a=$(this).data("type"),d($(this).data("type").toLowerCase())}),$(".internet-package .sim-type").on("click","section",function(){var t=$(this).find("input:radio").prop("checked",!0);$(t).parent().parent().parent().find("section.active").removeClass("active"),$(t).parent().parent().addClass("active"),d($(".internet-package").find(".operator.active").data("type").toLowerCase(),$(this).data("type"))}),$(".internet-package").on("change","select",function(){d($(".internet-package").find(".operator.active").data("type").toLowerCase(),$(".internet-package").find("section.active").data("type"),$(this).find("option:selected").data("package-type"))}),$(".save label").on("click",function(){1==$(".save-information").prop("checked")&&($.cookie("cellphone",$("#dataCellphone").val()),$.cookie("email",$("#dataEmail").val()))})});