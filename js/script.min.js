$(document).ready(function(){var e=false;var l="TopUp";var p="MTN";var g=$(window).outerHeight();if(g>638){g=638}$("#dataChargeKind").val("");var m=g-175;var o={Bill:false,GiftCard:false,Antivirus:false,InternetPackage:false};$(".load").css("height",g+"px");$(".sticky-menu").hide();$("#CellphoneInput").val($.cookie("cellphone"));$("#EmailInput").val($.cookie("email"));$(window).ready(function(){if($(window).outerWidth()<1001){$(".slider").css("height","auto")}else{$(".slider").css("height",m+"px")}k()});$(window).resize(function(){if($(window).outerWidth()<1001){$(".slider").css("height","auto")}else{$(".slider").css("height",m+"px")}k()});var a=0;$(".menu div").click(function(){if(a==0){$(".sticky-menu").fadeIn();a++}if($(this).data("type")==$("#dataChargeKind").val()){return false}$(".invoice .antivirus li").css("margin-bottom","15px");$(".giftcard-types").removeClass("active");$(".antivirus-types").removeClass("active");var t="."+$(this).data("type").toLowerCase();if(t==".internetpackage"){t=".internet-package"}$(".invoice div").slideUp(300,"swing");$(".invoice "+t).slideDown(300,"swing");$(".hint-cell, .hint-mail").slideUp();$(".information").css("padding","36px 0");$(".checkbox").prop("checked",false);$(".operator").removeClass("active");$(".menu div").removeClass("active");$(this).addClass("active");$("#dataChargeKind").val($(this).data("type"));l=$("#dataChargeKind").val();$(t+" div:first-child div:first-child").addClass("active");$(".slider, .header").slideUp(700,"swing");$(".content").slideDown(1100,"swing");$(".bargain > section").slideUp();$(t).slideDown();$("#product-type").html($(t+" div:first-child div:first-child").data("name"));$("#dataType").val($(t+" div:first-child div:first-child").data("type"));$(".charge-button").prop("checked",false);$(t+" .charge-type-container section:first-child input").prop("checked",true);$(".charge-type div").hide();$(t+" .charge-type-container section:first-child div").show();$("#dataAmount").val($(t+" .charge-type-container section:first-child label").data("price"));$(".counter").val(1);$(".magiccharge, .nonecredit-mtn, .wimax").show();if($(this).data("type")=="giftcard"){c("giftCard",$(".giftcard-types.active").data("giftcard-type"))}if($(this).data("type")=="antivirus"){c("antivirus",$(".antivirus-types.active").data("antivirus-type"));$(".invoice .antivirus li").css("margin-bottom","5px")}if($(this).data("type")=="InternetPackage"){$("input[type=radio][name=radio-sim-type][value=Prepaid]").prop("checked",true);b("mtn",$("option:selected").data("package-type"),"Prepaid");d();return}j()});$(".charge-type").click(function(){$(".charge-type div").hide();$(this).find("div").show();$(".counter").val(1);price=$(this).data("price");$("#dataAmount").val(price);$("#product-price").html(price+" تومان");j()});$(".operator").click(function(){$(".checkbox").prop("checked",false);$(".operator").removeClass("active");$(this).addClass("active");$(".counter").val(1);$("#product-type").html($(this).data("name"));$("#dataType").val($(this).data("type"));p=$(this).data("type");if($("#dataType").val()=="MTN"){$(".magiccharge label").text("شارژ شگفت انگیز");$(".magiccharge, .nonecredit-mtn, .wimax").show()}else{if($("#dataType").val()=="RTL"){$(".magiccharge label").text("شارژ شور انگیز");$(".magiccharge").show();$(".nonecredit-mtn, .wimax").hide()}else{$(".magiccharge, .nonecredit-mtn, .wimax").hide()}}j()});$(".increase").click(function(){countBoxValue=parseInt($(".counter").val());if(countBoxValue>=1&&countBoxValue<5){$(".counter").val(countBoxValue+1);j()}});$(".decrease").click(function(){countBoxValue=parseInt($(".counter").val());if(countBoxValue>1){$(".counter").val(countBoxValue-1);j()}});$(".checkbox").change(function(){var t=["magiccharge","nonecredit-mtn","wimax"];var u=$(this).attr("id");$.each(t,function(v,w){if(u!=w){$("#"+w).prop("checked",false)}});if($("#dataType").val()=="MTN"||$("#dataType").val()=="MTN!"||$("#dataType").val()=="MTN#"||$("#dataType").val()=="WiMax"){if(u=="magiccharge"){$("#dataType").val("MTN!")}else{if(u=="nonecredit-mtn"){$("#dataType").val("MTN#")}else{if(u=="wimax"){$("#dataType").val("WiMax")}}}if($(this).prop("checked")==false){$("#dataType").val("MTN")}}else{if($("#dataType").val()=="RTL"||$("#dataType").val()=="RTL!"){if(u=="magiccharge"){$("#dataType").val("RTL!")}if($(this).prop("checked")==false){$("#dataType").val("RTL")}}}p=$("#dataType").val()});$(document).on("input","input.cellphone",function(){this.value=this.value.replace(/[^\d\.\-]/g,"")});function n(u){var t=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;if(t.test(u)){return true}else{return false}}$(".counter").keydown(function(){return false});$(".internet-package option").click(function(){$(".package div").hide();var t=$(this).data("package-type").toLowerCase();$("."+t).slideDown()});$("input[type=radio][name=radio-sim-type]").change(function(){if(this.value=="Prepaid"){b("mtn",$("option:selected").data("package-type"),"Prepaid")}else{if(this.value=="Postpaid"){b("mtn",$("option:selected").data("package-type"),"Postpaid")}}});$("section.internet-package select").change(function(){$("input[type=radio][name=radio-sim-type][value=Prepaid]").prop("checked",true);b("mtn",$(this).find(":selected").data("package-type"),"Prepaid");if($(this).find(":selected").data("package-type")=="IN-MTN-TDLTE"){$(".sim-type").hide();$(".package").css("margin-top","30px")}else{$(".sim-type").show();$(".package").css("margin-top","0px")}});$(document).on("click",".package section",function(){$(".package section").removeClass("active");$(this).addClass("active");$("#dataPackageId").val($(this).data("package-id"));$("#dataAmount").val($(this).data("price"));var t=$(this).find("div").html().split(",")[0];$("#package-name").text(t);d()});$(".return").click(function(){$(".load").fadeOut()});$(".giftcard-types").click(function(){$(".giftcard-types").removeClass("active");$(this).addClass("active");$(".counter").val(1);c("giftCard",$(this).data("giftcard-type"));j()});$(".antivirus-types").click(function(){$(".antivirus-types").removeClass("active");$(this).addClass("active");$(".counter").val(1);c("antivirus",$(this).data("antivirus-type"));j()});$(document).on("click",".list section",function(){$(".list section").removeClass("active");$(this).addClass("active");$("#dataProductId").val($(this).data("product-id"));$("#dataAmount").val($(this).data("price"));$("#product-type").html($(".list section.active div:first-child").html());j()});$(".gateway").click(function(){$(".gateway").removeClass("active");$(this).addClass("active");$("#dataIssuer").val($(this).data("gateway-type"))});$(".submit").click(function(u){if($("#dataChargeKind").val()=="bill-payment"&&($("#dataBillId").val()==""||$("#dataPaymentId")=="")){$(".hint-bill").text("شناسه قبض و شناسه پرداخت را وارد نمایید","تذکر");$(".hint-bill").slideDown();return false}$(".load section:first-child").fadeIn();$(".load section:last-child").hide();u.preventDefault();var t="";if($("#dataChargeKind").val()=="TopUp"){t="topup"}else{if($("#dataChargeKind").val()=="InternetPackage"){t="internetRecharge"}else{if($("#dataChargeKind").val()=="bill-payment"){t="bill"}else{if($("#dataChargeKind").val()=="PIN"){t="buyProduct";$("#dataProductId").val("CC-"+$("#dataType").val()+"-"+$("#dataAmount").val())}else{t="buyProduct"}}}}f();if(e){$(".load").fadeIn();$(".load section:first-child p").text("دریافت اطلاعات ...");$.ajax({type:"POST",url:"https://chr724.ir/services/v3/EasyCharge/"+t,data:$("form#myForm").serialize(),async:false,contentType:"application/json",dataType:"jsonp",crossDomain:true,success:function(v){$(".load section:first-child p").text("انتقال به بانک ...");r(v)},error:function(v){$(".load section:first-child").fadeOut();$(".load section:last-child p").text("در حال حاضر امکان برقرار ارتباط با سرور وجود ندارد. (خطا: "+v.status+")<br>لطفاً بعداً مراجعه نمایید.","خطا");$(".load section:last-child").removeClass("hide")}});if($("input.save-information").prop("checked")){$.cookie("cellphone",$("input#dataCellphone").val());$.cookie("email",$("input#dataEmail").val())}}return false});function r(t){if(t.status=="Success"){if($("#dataIssuer").val()=="Zarinpal"){Zarinak.setAuthority(t.paymentInfo.paymentGateway.authority);Zarinak.open();$(".connecting p").text("لطفاً صبر کنید ...")}else{window.location.replace(t.paymentInfo.url)}}else{console.log(t);$(".load section:first-child").hide();$(".load section:last-child p").text(t.errorMessage);$(".load section:last-child").removeClass("hide");$(".load section:last-child").show()}}function f(){$(".hint-cell, .hint-mail").slideUp();$(".hint-cell p").text("شماره وارد شده صحیح نیست.");$("#dataCellphone").val($("input.cellphone").val());$("#dataEmail").val($("input.email").val());var y=true;var w=true;var x=true;var t=true;var z=true;var B=$("input.cellphone").val();var A=$("input.email").val();var v=l;if(jQuery.inArray(l,["PIN","TopUp","WiMax"])>-1){v="charge"}if(l=="TopUp"){if(B.length==11&&!isNaN(B)){if(p=="MTN"||p=="MTN!"||p=="MTN#"){if(jQuery.inArray(B.substring(0,3),["093","090"])==-1){w=false}}else{if(p=="MCI"){if(jQuery.inArray(B.substring(0,3),["091","099"])==-1){w=false}}else{if(p=="RTL"||p=="RTL!"){if(jQuery.inArray(B.substring(0,4),["0921","0922"])==-1){w=false}}else{if(B.length==11&&!isNaN(B)){if(p=="WiMax"){if(jQuery.inArray(B.substr(0,3),["094"])==-1){w=false;$(".hint-cell p").text("شماره وارد شده صحیح نیست.")}}}}}}}else{if(B.length==0){w=false;$(".hint-cell p").text("شماره موبایل خود را وارد کنید.")}else{w=false}}var u=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(A.length>0&&!u.test(A)){x=false}}else{if(l=="PIN"){if((B.length==0||jQuery.inArray(B,["093","090","091","092","0932"])!=-1)&&A.length==0){w=false;y=false;$(".hint-cell p").text("جهت استفاده از خدمات پشتیبانی، ایمیل یا شماره موبایل خود را وارد نمایید.")}else{var u=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(A.length>0&&!u.test(A)){x=false}if(x&&jQuery.inArray(B,["093","090","091","092","0932"])==-1){if(B.length==11&&!isNaN(B)){if(jQuery.inArray(B.substr(0,3),["090","091","092","093","099"])==-1){w=false}else{w=true}}else{if(B.length==0){w=true}else{w=false}}}}}else{if(l=="InternetPackage"){if(B.length==11&&!isNaN(B)){if($("option:selected").data("package-type")=="IN-MTN-TDLTE"){if(jQuery.inArray(B.substr(0,3),["094"])==-1){w=false;$(".hint-cell p").text("شماره وارد شده صحیح نیست.")}}else{if(jQuery.inArray(B.substring(0,3),["093","090"])==-1){w=false}}}else{if(B.length==0){w=false;$(".hint-cell p").text("شماره موبایل خود را وارد کنید.")}else{w=false}}var u=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(A.length>0&&!u.test(A)){x=false}}else{if(B.length==0&&A.length==0){y=false;if($("#dataChargeKind").val()=="bill-payment"){$(".hint-cell p").text("جهت استفاده از خدمات پشتیبانی، ایمیل یا شماره موبایل خود را وارد نمایید.")}else{$(".hint-cell p").text("سریال محصولات خریداری شده تنها به شماره موبایل شما ارسال خواهد شد.")}}else{var u=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(A.length>0&&!u.test(A)){x=false}if(B.length>0){if(B.length==11&&!isNaN(B)){if(jQuery.inArray(B.substr(0,3),["090","091","092","093","099"])==-1){w=false}else{w=true}}else{w=false}}else{w=false;$(".hint-cell p").text("سریال محصولات خریداری شده تنها به شماره موبایل شما ارسال خواهد شد.")}}}}}if(w==false){$(".hint-cell").slideDown();$(".information").css("padding","15px 0")}else{$(".hint-cell").slideUp();$(".information").css("padding","36px 0")}if(x==false){$(".hint-mail").slideDown();$(".information").css("padding","15px 0")}else{$(".hint-mail").slideUp();$(".information").css("padding","36px 0")}if(y==false){$(".hint-cell").slideDown();$(".information").css("padding","15px 0")}if(l=="PIN"||l=="TopUp"){if($("input#dataAmount").val()<500||$("input#dataAmount").val()>50000){if($("div.input.text.amount div.message").length<=0){$("div.input.text.amount").prepend('<div class="message error-message">مبلغ وارد شده میبایست بزرگتر از 500 و کوچک تر از 50،000 تومان باشد.</div>');$("div.input.select.amount").prepend('<div class="message error-message">مبلغ وارد شده میبایست بزرگتر از 500 و کوچک تر از 50،000 تومان باشد.</div>')}z=false}else{$("div.input.text.amount div.message").remove();z=true}}if(y&&w&&x&&z){e=true}else{e=false}}$("input#CheckBill").click(function(){$(".invoice .bill-payment .final-price").text("");$(".invoice .bill-payment .product-type").css("display","none");$(".hint-bill, .hint-pay").slideUp();var H=true;var F=true;var v=true;var C=true;var y=true;var x=true;var G=$("#CellphoneInput").val();var D=$("#EmailInput").val();var B=$("#BillId").val();var I=$("#PaymentId").val();if(B==""||I==""){C=true;$(".hint-bill").text("شناسه قبض و شناسه پرداخت را وارد نمایید","تذکر");$(".hint-bill").slideDown();return}if(isNaN(B)||isNaN(I)){C=false;$(".hint-bill").text("شناسه قبض و شناسه پرداخت فقط باید عدد باشند.","تذکر");$(".hint-bill").slideDown()}else{if(!h(B.replace(/^[0]+/g,""))){H=false}if(!h(I.substr(0,I.length-1).replace(/^[0]+/g,""))){F=false}if(!h(B.replace(/^[0]+/g,"")+I.replace(/^[0]+/g,""))){v=false}}if(C&&H&&F){if(!v){$(".hint-bill").text("شناسه قبض با شناسه پرداخت همخوانی ندارد.","تذکر");$(".hint-bill").slideDown();return}var A=["آب","برق","گاز","تلفن ثابت","تلفن همراه","عوارض شهرداری","","","راهنمایی و رانندگی"];var u=["water","electricity","gas","telephone","cellphone","mayoralty","","","police"];var t=B.length;var E=I.length;var w=B.substr((t-2),1)-1;var z=I.substr(0,(E-5))*100;$("#dataBillId").val(B);$("#dataPaymentId").val(I);$("#dataAmount").val(z);$(".invoice .bil-payment .product-type").text(A[w]);$(".invoice .bill-payment .final-price").text(z+" تومان");$(".invoice .bill-payment .product-type").addClass(u[w]);$(".invoice .bill-payment .product-type").css("display","inline-block")}if(H==false){if($(".buy.bill .bill-id div.message").length<=0){$(".hint-bill").text("شناسه قبض معتبر نیست.");$(".hint-bill").slideDown()}}if(F==false){if($(".buy.bill .payment-id div.message").length<=0){$(".hint-pay").text("شناسه پرداخت معتبر نیست.");$(".hint-pay").slideDown()}}});function h(u){var t=u.substr(u.length-1,1);u=u.substr(0,u.length-1);u=u.split("");coefficient=2;billLength=u.length;sum=0;for(i=(billLength-1);i>=0;i--){sum+=coefficient*u[i];coefficient++;if(coefficient==8){coefficient=2}}calculatedCheckSum=sum%11;if(calculatedCheckSum==1||calculatedCheckSum==0){calculatedCheckSum=0}else{calculatedCheckSum=11-calculatedCheckSum}if(calculatedCheckSum==t){return true}return false}$.ajax({type:"GET",url:"https://chr724.ir/services/v3/EasyCharge/initializeData",data:"{}",async:false,contentType:"application/json",dataType:"jsonp",crossDomain:true,success:function(t){products=t.products;paymentGateways=t.paymentGateways;s();$(".load").fadeOut()},error:function(t){$(".load section:first-child").hide();$(".load section:last-child p").text("در حال حاضر امکان برقرار ارتباط با سرور وجود ندارد. (خطا: "+t.status+")لطفاً بعداً مراجعه نمایید.","خطا");$(".load section:last-child").removeClass("hide")}});function s(){var u=0;$.each(paymentGateways,function(v,w){$(".gateway[data-gateway-type="+w+"]").css("display","inline-block");u+=1});if(u>3){$(".gateways-container").css("margin","10px auto")}else{$(".gateways-container").css("margin","40px auto")}$.each(products,function(v,w){if(jQuery.isEmptyObject(w)){$("#content fieldset > ."+v).html('<p class="service-caution">در حال حاضر در این دسته محصولی برای فروش وجود ندارد.</p>')}});$.each(paymentGateways,function(v,w){$("div.payment-gateways ul li#"+w).attr("style","display:inline-block;")});$("div.payment-gateways ul").attr("style","width:"+paymentGateways.length*55+"px;");$.each(products.giftCard,function(v,w){if(w==""||w==null){$(".giftcard-types."+v).hide()}else{$(".giftcard-types."+v).css("display","inline-block")}});$.each(products.antivirus,function(v,w){v=v.toLowerCase();if(w==""||w==null){$(".antivirus-types."+v).hide()}else{$(".antivirus-types."+v).css("display","inline-block")}});$(".bgs").slideDown(300);var t=window.location.href;if(t.match("#topup$")){$('div[data-type="TopUp"]').trigger("click")}else{if(t.match("#pin$")){$('div[data-type="PIN"]').trigger("click")}else{if(t.match("#internetPackage$")){$('div[data-type="InternetPackage"]').trigger("click")}else{if(t.match("#bill$")){$('div[data-type="bill-payment"]').trigger("click")}else{if(t.match("#giftcard$")){$('div[data-type="giftcard"]').trigger("click")}else{if(t.match("#antivirus$")){$('div[data-type="antivirus"]').trigger("click")}}}}}}}function c(w,v){var t="";if(v!=""){var u=products[w][v]}else{var u=products[w]}groupPascalCase=w.charAt(0).toUpperCase()+w.slice(1);$.each(u,function(x,y){t+='<section data-product-id="'+y.id+'" data-price="'+y.price+'"><div  class="credit-info">'+y.name+'</div><div class="price-info">'+y.price+" تومان</div><div class='clear'></div></section>"});$(".list").html(t).show();$("#dataProductId").val($(".list section:first-child").data("product-id"));$("#dataAmount").val($(".list section:first-child").data("price"));$(".list section:first-child").addClass("active");q();$("#product-type").html($(".list section.active div:first-child").html())}function q(){$(".list section div:first-child").css("direction","rtl");$('.list section div:first-child:contains("گیفت کارت")').each(function(){$(this).html($(this).html().split("گیفت کارت").join(""))});$('.list section div:first-child:contains("XBox")').each(function(){$(this).html($(this).html().split("XBox").join("ایکس باکس "))});$('.list section div:first-child:contains("PlayStationNetwork")').each(function(){$(this).html($(this).html().split("PlayStationNetwork").join(""));$(this).prepend("پلی استیشن ")});$('.package section div:first-child:contains("اینترنت ایرانسل")').each(function(){$(this).html($(this).html().split("اینترنت ایرانسل").join(""))});$('.package section div:first-child:contains("اینترنت ثابت TDLTE")').each(function(){$(this).html($(this).html().split("اینترنت ثابت TDLTE").join("ثابت"))});$('.package section div:first-child:contains("(مشترکین دائمی)")').each(function(){$(this).html($(this).html().split("(مشترکین دائمی)").join(""))});$('.package section div:first-child:contains("(مشترکین اعتباری)")').each(function(){$(this).html($(this).html().split("(مشترکین اعتباری)").join(""))})}function b(x,w,u){console.log(u);var t=["IN-MTN-Hourly","IN-MTN-Daily","IN-MTN-Weekly","IN-MTN-Monthly","IN-MTN-Amazing","IN-MTN-TDLTE"];var v=["اینترنت ایرانسل ساعتی","اینترنت ایرانسل روزانه","اینترنت ایرانسل هفتگی","اینترنت ایرانسل ماهانه","اینترنت ایرانسل شگفت انگیز","اینترنت ثابت TDLTE"];stringData=JSON.stringify(products);$.each(t,function(C,D){stringData=stringData.replace('"'+v[C]+'"','"'+D+'"')});var A=JSON.parse(stringData)["internetPackage"];var z=A[x][w];$("select#InternetPackage"+w+"Types").find("option").remove();var B="";var y=true;$.each(z,function(C,D){if(u=="Prepaid"){if(D.name.includes("مشترکین دائمی")!=true){y=false;B+='<section data-package-id="'+D.id+'" data-price="'+D.price+'"><div  class="credit-info">'+D.name+", "+D.price+" تومان</div></section>"}}else{if(u=="Postpaid"){if(D.name.includes("مشترکین دائمی")==true){y=false;B+='<section data-package-id="'+D.id+'" data-price="'+D.price+'"><div  class="credit-info">'+D.name+", "+D.price+" تومان</div></section>"}}}});$(".package").html(B).show();q();$(".package section:first-child").addClass("active");$("#dataPackageId").val($(".package section:first-child").data("package-id"));$("#dataAmount").val($(".package section:first-child").data("price"));if($(".package section:first-child").find("div").length!=0){$("#package-name").html($(".package section:first-child").find("div").html().split(",")[0])}else{$("#package-name").html("")}if(y==true){$("select#InternetPackage"+w+"Types").css({color:"#E52721"});$("select#InternetPackage"+w+"Types").append($(".package").html("بسته ای در این دسته وجود ندارد."));$(".package").css("direction","rtl")}else{$("select#InternetPackage"+w+"Types").css({color:"#5c5c5c"});$(".package").css("direction","ltr")}$(".container.InternetPackage .InternetPackage input#UnitAmount").val($("select#InternetPackage"+w+"Types").find("option:first-child").data("price"));console.log(B);d()}function j(){var u=$(".counter").val();var t=$("#dataAmount").val();$("input[name='data[count]']").val(u);if(t==""){$("#product-count").html("");$("#product-price").html("");$("#final-price , .price").html("")}else{$("#product-count").html(u+" عدد");$("#product-price").html(t+" تومان");$("#final-price , .price").html((t*u)+" تومان");$("get-final-price").val(t)}}function d(){var u=$("#dataAmount").val();var t=1;$("#dataCount").val(1);if(u==""){$("#package-price").html("")}else{$("#package-price").html((u*t)+" تومان")}}function k(){if($(window).outerWidth()<501){var t=($(window).height()-$(".slider").height()-31)/3+"px";console.log(t);$(".menu div").css("height",t)}else{$(".menu div").css("height","auto")}}$(".save label").on("click",function(){if($(".save-information").prop("checked")==true){$.cookie("cellphone",$("#dataCellphone").val());$.cookie("email",$("#dataEmail").val())}})});